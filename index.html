<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Parcel Locker</title>

<script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>

<style>
body{
    background:#0f172a;
    color:white;
    font-family:sans-serif;
    text-align:center;
    padding-top:60px;
}

.card{
    background:#1e293b;
    padding:30px;
    width:300px;
    margin:auto;
    border-radius:20px;
}

input{
    width:90%;
    padding:10px;
    border-radius:10px;
    border:none;
    font-size:18px;
    text-align:center;
}

button{
    margin-top:15px;
    padding:10px 20px;
    border:none;
    border-radius:10px;
    background:#10b981;
    color:white;
    font-size:16px;
    cursor:pointer;
}

#status{
    margin-top:20px;
    font-size:14px;
}

#result{
    margin-top:15px;
    font-weight:bold;
}
</style>
</head>
<body>

<div class="card">
    <h2>üì¶ ‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏û‡∏±‡∏™‡∏î‡∏∏</h2>

    <input type="text" id="parcelCode" placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™">

    <br>
    <button onclick="checkParcel()">üîì ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πà‡∏≠‡∏á</button>

    <div id="result"></div>
    <div id="status">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ MQTT...</div>
</div>

<script>

// üîπ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ MQTT
const statusEl = document.getElementById("status");

const client = mqtt.connect("wss://broker.emqx.io:8084/mqtt");

client.on("connect", function() {
    statusEl.innerHTML = "‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ MQTT ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
});

client.on("error", function(err){
    statusEl.innerHTML = "‚ùå ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
    console.log(err);
});

// üîπ ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πà‡∏≠‡∏á
function checkParcel(){

    let input = document.getElementById("parcelCode").value.trim();

    if(input === ""){
        document.getElementById("result").innerHTML = "‚ö† ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™";
        return;
    }

    // ‡∏™‡πà‡∏á‡πÑ‡∏õ topic open
    client.publish("open", input);

    document.getElementById("result").innerHTML = 
    "üì§ ‡∏™‡πà‡∏á‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß...";
}

</script>

</body>
</html>
